<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text x='.07em' y='.82em' font-size='100'>📝</text></svg>"><title>git-auto-push for windows</title><link rel="stylesheet" href="https://storage.roamnote.com:8000/index.css"><script src="https://storage.roamnote.com:8000/fuse.js"></script>
<script src="https://storage.roamnote.com:8000/index.js"></script>
<script>window.onload=async()=>{moveBreadcrumb(),closeTocWhenScroll(),updateHeaderBgColor(),initialSearch("https://storage.roamnote.com:8000/index.json")}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-QC2GM314WK"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QC2GM314WK")</script></head><body><header><nav id="Breadcrumb"><a href="/" title="漫游笔记" data-short-title="🏠"><span>🏠 漫游笔记</span></a>
<a href="/play-with-code/" title="Play With Code" data-short-title="Play"><span title="Play With Code">Play With Code</span></a>
<a href="/play-with-code/git-auto-push-for-windows/" title="git-auto-push for windows" data-short-title="git-"><span id="LastBreadcrumb" title="git-auto-push for windows">git-auto-push for windows</span></a></nav><div id="Toolbar" data-nosnippet=""><details id="TocButton"><summary><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"></path></svg></summary><nav id="TableOfContents"><ul><li><a href="#安装git">安装git</a></li><li><a href="#bat脚本">bat脚本</a></li><li><a href="#后台自动运行脚本">后台自动运行脚本</a><ul><li><a href="#后台执行脚本">后台执行脚本</a></li><li><a href="#部署计划任务">部署计划任务</a></li></ul></li></ul></nav><div id="TocHeaderMask"></div></details><button id="SearchButton">🔍</button></div></header><div id="SearchBox" data-nosnippet=""><input id="SearchInput" tabindex="0" autocomplete="off" placeholder="搜索"><div id="SearchToolBar"></div><div id="SearchResults" class="no-hover"></div></div><main><article pageurl="/play-with-code/git-auto-push-for-windows/" pagetitle="git-auto-push for windows"><h1 id="a0">git-auto-push for windows</h1><time id="UpdateDate">2024年01月22日</time><aside id="TocArticle"><nav id="TableOfContents"><ul id="a4"><li id="a5"><a href="#安装git" id="a6">安装git</a></li><li id="a7"><a href="#bat脚本" id="a8">bat脚本</a></li><li id="a9"><a href="#后台自动运行脚本" id="a10">后台自动运行脚本</a><ul id="a11"><li id="a12"><a href="#后台执行脚本" id="a13">后台执行脚本</a></li><li id="a14"><a href="#部署计划任务" id="a15">部署计划任务</a></li></ul></li></ul></nav></aside><a id="fixYOffset" class="internal-link" href="#" style=""></a><blockquote id="a17"><p id="a18">logseq 官方维护了一个 <a href="https://github.com/logseq/git-auto" class="external-link" target="_blank" id="a19">git-auto</a>，有丰富的配置，开箱即用。而我这个则比较简陋，不支持丰富配置，但是比较容易看懂。如果不需要复杂的功能，我这个办法也挺香的。</p></blockquote><p id="a20"><span class="unwrap" id="a21">现在logseq已经内置git版本控制，这篇文章的内容可能没有帮助了。</span></p><p id="a22"><span class="unwrap" id="a23"><img alt="20220410182228.png" src="https://storage.roamnote.com:8000/20220410182228.png" width="3104" style="aspect-ratio: 3104 / 1824;" id="a24"></span></p><h2 class="heading" id="安装git">安装git<a class="heading-anchor" href="/play-with-code/git-auto-push-for-windows/#%e5%ae%89%e8%a3%85git" id="a26"></a></h2><p id="a27"><span class="unwrap" id="a28">首先需要在电脑上安装好 git，<a href="http://git-scm.com/download/win" class="external-link" target="_blank" id="a29">下载地址</a>。</span></p><p id="a30"><span class="unwrap" id="a31">然后在安装目录里找到 <code id="a32">git.exe</code> 文件。如图：</span></p><p id="a33"><span class="unwrap" id="a34"><img alt="20210228183844.png" src="https://storage.roamnote.com:8000/20210228183844.png" width="440" style="aspect-ratio: 440 / 231;" id="a35"></span></p><p id="a36"><span class="unwrap" id="a37">右键查看其属性，找到其路径备用。如图：</span></p><p id="a38"><span class="unwrap" id="a39"><img alt="20210228185509.png" src="https://storage.roamnote.com:8000/20210228185509.png" width="461" style="aspect-ratio: 461 / 324;" id="a40"></span></p><h2 class="heading" id="bat脚本">bat脚本<a class="heading-anchor" href="/play-with-code/git-auto-push-for-windows/#bat%e8%84%9a%e6%9c%ac" id="a42"></a></h2><p id="a43"><span class="unwrap" id="a44">在任意位置新建一个文件 <code id="a45">AutoPush.bat</code>，名字也是任意的，写入以下内容：</span></p><div class="highlight" id="a46"><pre tabindex="0" style="overflow: hidden;" class="torchlight" data-torchlight-processed="3449c9e5e332f1dbb81505cd739fbf3f" onmouseenter="setTimeout(function() { this.style.overflow = 'auto'; }.bind(this), 300)" onmouseleave="this.style.overflow = 'hidden';" ontouchstart="setTimeout(function() { this.style.overflow = 'auto'; }.bind(this), 300)" id="a47"><button data-text="复制" onclick="window.navigator.clipboard.writeText(nextElementSibling.innerText.replace(/&nbsp;/g, ''));this.setAttribute('data-text', '已复制');style='background-color: #009900';setTimeout(() => {this.setAttribute('data-text', '复制');this.removeAttribute('style')}, 1000);" id="a48"></button><code class="language-bash" data-lang="bash" id="a49"><!-- Syntax highlighted by torchlight.dev --><div class="line" id="a50"><span style="color: #F8F8F2;" id="a51">@echo </span><span style="color: #E6DB74;" id="a52">off</span></div><div class="line" id="a53">&nbsp;</div><div class="line" id="a54"><span style="color: #F8F8F2;" id="a55">@REM </span><span style="color: #E6DB74;" id="a56">进入到项目目录</span></div><div class="line" id="a57"><span style="color: #66D9EF;" id="a58">cd</span><span style="color: #F8F8F2;" id="a59"> </span><span style="color: #E6DB74;" id="a60">"C:\xxx\xxx"</span></div><div class="line" id="a61">&nbsp;</div><div class="line" id="a62"><span style="color: #F8F8F2;" id="a63">@REM </span><span style="color: #E6DB74;" id="a64">git</span><span style="color: #F8F8F2;" id="a65"> </span><span style="color: #E6DB74;" id="a66">目录</span></div><div class="line" id="a67"><span style="color: #66D9EF;" id="a68">set</span><span style="color: #F8F8F2;" id="a69"> </span><span style="color: #E6DB74;" id="a70">GIT_PATH="D:\App\Git\cmd\git.exe"</span></div><div class="line" id="a71">&nbsp;</div><div class="line" id="a72"><span style="color: #F8F8F2;" id="a73">@REM </span><span style="color: #E6DB74;" id="a74">设置分支</span></div><div class="line" id="a75"><span style="color: #66D9EF;" id="a76">set</span><span style="color: #F8F8F2;" id="a77"> </span><span style="color: #E6DB74;" id="a78">BRANCH</span><span style="color: #F8F8F2;" id="a79"> </span><span style="color: #E6DB74;" id="a80">=</span><span style="color: #F8F8F2;" id="a81"> </span><span style="color: #E6DB74;" id="a82">"origin"</span></div><div class="line" id="a83">&nbsp;</div><div class="line" id="a84"><span style="color: #F8F8F2;" id="a85">@REM </span><span style="color: #E6DB74;" id="a86">循环标记</span></div><div class="line" id="a87"><span style="color: #F8F8F2;" id="a88">:loop </span></div><div class="line" id="a89">&nbsp;</div><div class="line" id="a90"><span style="color: #F8F8F2;" id="a91">@REM </span><span style="color: #E6DB74;" id="a92">add</span><span style="color: #F8F8F2;" id="a93"> </span><span style="color: #E6DB74;" id="a94">命令</span></div><div class="line" id="a95"><span style="color: #F8F8F2;" id="a96">%GIT_PATH% </span><span style="color: #E6DB74;" id="a97">add</span><span style="color: #F8F8F2;" id="a98"> </span><span style="color: #AE81FF;" id="a99">-A</span></div><div class="line" id="a100">&nbsp;</div><div class="line" id="a101"><span style="color: #F8F8F2;" id="a102">@REM </span><span style="color: #E6DB74;" id="a103">commit</span><span style="color: #F8F8F2;" id="a104"> </span><span style="color: #E6DB74;" id="a105">命令</span></div><div class="line" id="a106"><span style="color: #F8F8F2;" id="a107">%GIT_PATH% </span><span style="color: #E6DB74;" id="a108">commit</span><span style="color: #F8F8F2;" id="a109"> </span><span style="color: #AE81FF;" id="a110">-m</span><span style="color: #F8F8F2;" id="a111"> </span><span style="color: #E6DB74;" id="a112">"auto commit"</span></div><div class="line" id="a113">&nbsp;</div><div class="line" id="a114"><span style="color: #F8F8F2;" id="a115">@REM </span><span style="color: #E6DB74;" id="a116">pull</span><span style="color: #F8F8F2;" id="a117"> </span><span style="color: #E6DB74;" id="a118">命令，如果不需要每次</span><span style="color: #F8F8F2;" id="a119"> </span><span style="color: #E6DB74;" id="a120">push</span><span style="color: #F8F8F2;" id="a121"> </span><span style="color: #E6DB74;" id="a122">之前都</span><span style="color: #F8F8F2;" id="a123"> </span><span style="color: #E6DB74;" id="a124">pull</span><span style="color: #F8F8F2;" id="a125"> </span><span style="color: #E6DB74;" id="a126">，可以把这个删除</span></div><div class="line" id="a127"><span style="color: #F8F8F2;" id="a128">%GIT_PATH% </span><span style="color: #E6DB74;" id="a129">pull</span><span style="color: #F8F8F2;" id="a130"> %BRANCH%</span></div><div class="line" id="a131">&nbsp;</div><div class="line" id="a132"><span style="color: #F8F8F2;" id="a133">@REM </span><span style="color: #E6DB74;" id="a134">push</span><span style="color: #F8F8F2;" id="a135"> </span><span style="color: #E6DB74;" id="a136">命令</span></div><div class="line" id="a137"><span style="color: #F8F8F2;" id="a138">%GIT_PATH% </span><span style="color: #E6DB74;" id="a139">push</span><span style="color: #F8F8F2;" id="a140"> %BRANCH%</span></div><div class="line" id="a141">&nbsp;</div><div class="line" id="a142"><span style="color: #F8F8F2;" id="a143">@REM </span><span style="color: #E6DB74;" id="a144">等待</span><span style="color: #F8F8F2;" id="a145"> </span><span style="color: #E6DB74;" id="a146">180</span><span style="color: #F8F8F2;" id="a147"> </span><span style="color: #E6DB74;" id="a148">秒</span></div><div class="line" id="a149"><span style="color: #F8F8F2;" id="a150">timeout </span><span style="color: #E6DB74;" id="a151">180</span><span style="color: #F8F8F2;" id="a152"> </span><span style="color: #F92672;" id="a153">&gt;</span><span style="color: #F8F8F2;" id="a154"> </span><span style="color: #E6DB74;" id="a155">NUL</span></div><div class="line" id="a156">&nbsp;</div><div class="line" id="a157"><span style="color: #F8F8F2;" id="a158">@REM </span><span style="color: #E6DB74;" id="a159">回到</span><span style="color: #F8F8F2;" id="a160"> </span><span style="color: #E6DB74;" id="a161">loop</span><span style="color: #F8F8F2;" id="a162"> </span><span style="color: #E6DB74;" id="a163">标记处</span></div><div class="line" id="a164"><span style="color: #F8F8F2;" id="a165">goto </span><span style="color: #E6DB74;" id="a166">loop</span></div></code></pre></div><p id="a167"><span class="unwrap" id="a168">至此，这个文件已经可以使用了，双击即可使用。如果想在后台自动运行，可以继续往下看。</span></p><h2 class="heading" id="后台自动运行脚本">后台自动运行脚本<a class="heading-anchor" href="/play-with-code/git-auto-push-for-windows/#%e5%90%8e%e5%8f%b0%e8%87%aa%e5%8a%a8%e8%bf%90%e8%a1%8c%e8%84%9a%e6%9c%ac" id="a170"></a></h2><h3 class="heading" id="后台执行脚本">后台执行脚本<a class="heading-anchor" href="/play-with-code/git-auto-push-for-windows/#%e5%90%8e%e5%8f%b0%e6%89%a7%e8%a1%8c%e8%84%9a%e6%9c%ac" id="a172"></a></h3><p id="a173"><span class="unwrap" id="a174">上面的 bat 脚本在运行的时候，会弹出 cmd 窗口，为了让其静默执行，需要另一个脚本来调用它，任意位置新建 <code id="a175">AutoPushDaemon.VBS</code>，写入以下内容：</span></p><div class="highlight" id="a176"><pre tabindex="0" style="overflow: hidden;" class="torchlight" data-torchlight-processed="3449c9e5e332f1dbb81505cd739fbf3f" onmouseenter="setTimeout(function() { this.style.overflow = 'auto'; }.bind(this), 300)" onmouseleave="this.style.overflow = 'hidden';" ontouchstart="setTimeout(function() { this.style.overflow = 'auto'; }.bind(this), 300)" id="a177"><button data-text="复制" onclick="window.navigator.clipboard.writeText(nextElementSibling.innerText.replace(/&nbsp;/g, ''));this.setAttribute('data-text', '已复制');style='background-color: #009900';setTimeout(() => {this.setAttribute('data-text', '复制');this.removeAttribute('style')}, 1000);" id="a178"></button><code class="language-vb" data-lang="vb" id="a179"><!-- Syntax highlighted by torchlight.dev --><div class="line" id="a180"><span style="color: #66D9EF;" id="a181">Set </span><span style="color: #F8F8F2;" id="a182">WshShell </span><span style="color: #F92672;" id="a183">=</span><span style="color: #F8F8F2;" id="a184"> </span><span style="color: #66D9EF;" id="a185">CreateObject</span><span style="color: #F8F8F2;" id="a186">(</span><span style="color: #E6DB74;" id="a187">"WScript.Shell"</span><span style="color: #F8F8F2;" id="a188">) </span></div><div class="line" id="a189"><span style="color: #F8F8F2;" id="a190">WshShell.Run </span><span style="color: #66D9EF;" id="a191">chr</span><span style="color: #F8F8F2;" id="a192">(</span><span style="color: #AE81FF;" id="a193">34</span><span style="color: #F8F8F2;" id="a194">) </span><span style="color: #F92672;" id="a195">&amp;</span><span style="color: #F8F8F2;" id="a196"> </span><span style="color: #E6DB74;" id="a197">"C:\AutoPushNote.bat"</span><span style="color: #F8F8F2;" id="a198"> </span><span style="color: #F92672;" id="a199">&amp;</span><span style="color: #F8F8F2;" id="a200"> </span><span style="color: #66D9EF;" id="a201">Chr</span><span style="color: #F8F8F2;" id="a202">(</span><span style="color: #AE81FF;" id="a203">34</span><span style="color: #F8F8F2;" id="a204">), </span><span style="color: #AE81FF;" id="a205">0</span></div><div class="line" id="a206"><span style="color: #66D9EF;" id="a207">Set </span><span style="color: #F8F8F2;" id="a208">WshShell </span><span style="color: #F92672;" id="a209">=</span><span style="color: #AE81FF;" id="a210"> Nothing</span></div></code></pre></div><h3 class="heading" id="部署计划任务">部署计划任务<a class="heading-anchor" href="/play-with-code/git-auto-push-for-windows/#%e9%83%a8%e7%bd%b2%e8%ae%a1%e5%88%92%e4%bb%bb%e5%8a%a1" id="a212"></a></h3><p id="a213"><span class="unwrap" id="a214">搜索 task ，找到任务计划程序。如图：</span></p><p id="a215"><span class="unwrap" id="a216"><img alt="20210228184723.png" src="https://storage.roamnote.com:8000/20210228184723.png" width="341" style="aspect-ratio: 341 / 678;" id="a217"></span></p><p id="a218"><span class="unwrap" id="a219">新建任务，如图：</span></p><p id="a220"><span class="unwrap" id="a221"><img alt="20210228185420.png" src="https://storage.roamnote.com:8000/20210228185420.png" width="765" style="aspect-ratio: 765 / 551;" id="a222"></span></p><p id="a223"><span class="unwrap" id="a224">名称和描述随意填写，如图：</span></p><p id="a225"><span class="unwrap" id="a226"><img alt="20210228185357.png" src="https://storage.roamnote.com:8000/20210228185357.png" width="692" style="aspect-ratio: 692 / 545;" id="a227"></span></p><p id="a228"><span class="unwrap" id="a229">触发器，这里为了每次开机都能运行，选择"当用户登录时"，如图：</span></p><p id="a230"><span class="unwrap" id="a231"><img alt="20210228212248.png" src="https://storage.roamnote.com:8000/20210228212248.png" width="691" style="aspect-ratio: 691 / 544;" id="a232"></span></p><p id="a233"><span class="unwrap" id="a234">选择启动程序，如图：</span></p><p id="a235"><span class="unwrap" id="a236"><img alt="20210228185927.png" src="https://storage.roamnote.com:8000/20210228185927.png" width="690" style="aspect-ratio: 690 / 545;" id="a237"></span></p><p id="a238"><span class="unwrap" id="a239">填写需要运行的脚本的完整路径，即上面新建的 <code id="a240">AutoPushDaemon.VBS</code>。如图：</span></p><p id="a241"><span class="unwrap" id="a242"><img alt="20210228190134.png" src="https://storage.roamnote.com:8000/20210228190134.png" width="692" style="aspect-ratio: 692 / 546;" id="a243"></span></p><p id="a244"><span class="unwrap" id="a245">最后保存。</span></p><p id="a246"><span class="unwrap" id="a247">首次运行需要手动操作，如图：</span></p><p id="a248"><span class="unwrap" id="a249"><img alt="20210228190332.png" src="https://storage.roamnote.com:8000/20210228190332.png" width="783" style="aspect-ratio: 783 / 560;" id="a250"></span></p></article><aside id="TocAside" data-nosnippet=""><style>@media(min-width:1201px) and (max-width:1500px){main{margin-left:calc(50% - 600px)!important}}</style><nav id="TableOfContents"><ul><li><a href="#安装git">安装git</a></li><li><a href="#bat脚本">bat脚本</a></li><li><a href="#后台自动运行脚本">后台自动运行脚本</a><ul><li><a href="#后台执行脚本">后台执行脚本</a></li><li><a href="#部署计划任务">部署计划任务</a></li></ul></li></ul></nav></aside><picture><source srcset="https://storage.roamnote.com:8000/bg.png"><img src="https://storage.roamnote.com:8000/bg.avif" decoding="async" alt="漫游笔记" width="1920" style="aspect-ratio:1920/441"></picture></main></body></html>